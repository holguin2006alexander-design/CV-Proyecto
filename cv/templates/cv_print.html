<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>CV | {{ perfil.nombres }} {{ perfil.apellidos }}</title>

  <style>
    /* ============================
       CV PRINT (A4) — Documento real
       Limpio, profesional, 2 columnas
       ============================ */

    @page { size: A4; margin: 12mm; }

    * { box-sizing: border-box; }

    body{
      margin:0;
      padding:0;
      font-family: "Inter", "Segoe UI", Arial, sans-serif;
      color:#0f172a;
      line-height: 1.35;
      font-size: 10.5pt;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
      background: #fff;
    }

    /* Contenedor A4 */
    .cv-page{
      width: 100%;
      min-height: 100%;
    }

    /* Header */
    .cv-header{
      display:flex;
      gap: 14mm;
      align-items: center;
      padding-bottom: 6mm;
      margin-bottom: 6mm;
      border-bottom: 1px solid #e5e7eb;
    }

    .cv-photo{
      width: 32mm;
      height: 32mm;
      border-radius: 10mm;
      overflow:hidden;
      border: 2px solid #e5e7eb;
      background:#cbd5e1;
      flex: 0 0 auto;
    }
    .cv-photo img{width:100%;height:100%;object-fit:cover;display:block}
    .cv-photo-fallback{
      width:100%;height:100%;
      display:flex;align-items:center;justify-content:center;
      font-weight: 900;
      font-size: 18pt;
      color:#fff;
      background: #0f172a;
    }

    .cv-name{
      margin:0;
      font-size: 20pt;
      font-weight: 900;
      letter-spacing: .6px;
      text-transform: uppercase;
      line-height: 1.05;
    }
    .cv-role{
      margin: 2mm 0 0;
      font-size: 11pt;
      font-weight: 700;
      color: #1d4ed8;
    }

    .cv-meta{
      margin-top: 3mm;
      display:flex;
      flex-wrap: wrap;
      gap: 2.2mm 6mm;
      color:#334155;
      font-size: 9.5pt;
    }
    .cv-meta span{white-space: nowrap}
    .cv-meta b{color:#0f172a}

    /* Layout 2 columnas */
    .cv-grid{
      display: grid;
      grid-template-columns: 64mm 1fr;
      gap: 10mm;
    }

    /* Columna izquierda (datos) */
    .side{
      padding-right: 6mm;
      border-right: 1px solid #e5e7eb;
    }

    /* Secciones */
    .sec{margin-bottom: 6mm;}
    .sec-title{
      font-size: 10.5pt;
      font-weight: 900;
      text-transform: uppercase;
      letter-spacing: .8px;
      color:#0f172a;
      margin: 0 0 3mm;
      padding-bottom: 1.5mm;
      border-bottom: 2px solid #e5e7eb;
    }

    /* Bloques tipo “campo” */
    .field{margin-bottom: 3.5mm;}
    .field .lab{
      display:block;
      font-size: 8pt;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: .6px;
      color:#64748b;
      margin-bottom: 1mm;
    }
    .field .val{
      font-weight: 650;
      color:#0f172a;
      word-break: break-word;
    }

    .link{
      color:#0f172a;
      text-decoration: none;
      word-break: break-all;
    }

    /* Columna derecha */
    .main{}

    /* Items (experiencia/educación) */
    .item{
      padding: 3.5mm 0;
      border-bottom: 1px dashed #e5e7eb;
      break-inside: avoid;
      page-break-inside: avoid;
    }
    .item:last-child{border-bottom:0}

    .item-top{
      display:flex;
      justify-content: space-between;
      gap: 6mm;
      align-items: baseline;
      margin-bottom: 1.8mm;
    }
    .item-title{
      font-weight: 900;
      font-size: 11pt;
      color:#0f172a;
    }
    .item-subtitle{
      font-weight: 750;
      color:#1d4ed8;
      font-size: 10pt;
      margin-top: .8mm;
    }
    .item-date{
      font-size: 9pt;
      font-weight: 800;
      color:#334155;
      white-space: nowrap;
      text-align:right;
    }
    .item-body{
      color:#334155;
      font-size: 10pt;
      text-align: justify;
      margin-top: 2mm;
    }

    /* Chips (pequeñas etiquetas) */
    .chip{
      display:inline-block;
      border: 1px solid #e5e7eb;
      background:#f8fafc;
      padding: 1.2mm 2.6mm;
      border-radius: 999px;
      font-size: 8.5pt;
      font-weight: 750;
      color:#0f172a;
      margin-right: 2mm;
      margin-bottom: 2mm;
    }

    /* Resumen */
    .summary{
      color:#334155;
      text-align: justify;
      margin-top: 2mm;
      font-size: 10pt;
    }

    /* Si alguna sección viene vacía, no dejes “huecos” gigantes */
    .muted{color:#64748b}

    /* Evita cortes feos */
    h1,h2,h3{page-break-after: avoid;}
  </style>
</head>

<body>
  <div class="cv-page">

    <!-- ================= HEADER ================= -->
    <header class="cv-header">
      <div class="cv-photo">
        {% if perfil.foto_perfil_url %}
          <img src="{{ perfil.foto_perfil_url }}" alt="Foto">
        {% else %}
          <div class="cv-photo-fallback">
            {{ perfil.nombres|slice:":1" }}{{ perfil.apellidos|slice:":1" }}
          </div>
        {% endif %}
      </div>

      <div style="flex:1">
        <h1 class="cv-name">{{ perfil.nombres }} {{ perfil.apellidos }}</h1>

        {% if perfil.descripcionperfil %}
          <div class="cv-role">{{ perfil.descripcionperfil }}</div>
        {% else %}
          <div class="cv-role">Currículum Vitae</div>
        {% endif %}

        <div class="cv-meta">
          <span><b>Cédula:</b> {{ perfil.numerocedula }}</span>
          {% if perfil.nacionalidad %}<span><b>Nacionalidad:</b> {{ perfil.nacionalidad }}</span>{% endif %}
          {% if perfil.lugarnacimiento %}<span><b>Origen:</b> {{ perfil.lugarnacimiento }}</span>{% endif %}
          {% if perfil.licenciaconducir %}<span><b>Licencia:</b> {{ perfil.licenciaconducir }}</span>{% endif %}
        </div>
      </div>
    </header>

    <!-- ================= BODY ================= -->
    <div class="cv-grid">

      <!-- ====== LEFT (INFO) ====== -->
      <aside class="side">

        <section class="sec">
          <h2 class="sec-title">Contacto</h2>

          {% if perfil.telefonoconvencional %}
          <div class="field">
            <span class="lab">Móvil / WhatsApp</span>
            <span class="val">{{ perfil.telefonoconvencional }}</span>
          </div>
          {% endif %}

          {% if perfil.telefonofijo %}
          <div class="field">
            <span class="lab">Teléfono fijo</span>
            <span class="val">{{ perfil.telefonofijo }}</span>
          </div>
          {% endif %}

          {% if perfil.sitioweb %}
          <div class="field">
            <span class="lab">Sitio web</span>
            <a class="val link" href="{{ perfil.sitioweb }}">{{ perfil.sitioweb }}</a>
          </div>
          {% endif %}
        </section>

        <section class="sec">
          <h2 class="sec-title">Datos personales</h2>

          {% if perfil.fechanacimiento %}
          <div class="field">
            <span class="lab">Fecha de nacimiento</span>
            <span class="val">{{ perfil.fechanacimiento|date:"d M Y" }}</span>
          </div>
          {% endif %}

          {% if perfil.estadocivil %}
          <div class="field">
            <span class="lab">Estado civil</span>
            <span class="val">{{ perfil.estadocivil }}</span>
          </div>
          {% endif %}

          {% if perfil.sexo %}
          <div class="field">
            <span class="lab">Género</span>
            <span class="val">
              {% if perfil.sexo == 'M' %}Masculino{% elif perfil.sexo == 'F' %}Femenino{% else %}{{ perfil.sexo }}{% endif %}
            </span>
          </div>
          {% endif %}
        </section>

        <section class="sec">
          <h2 class="sec-title">Ubicación</h2>

          <div class="field">
            <span class="lab">Domicilio</span>
            <span class="val">{{ perfil.direcciondomiciliaria|default:"—" }}</span>
          </div>

          {% if perfil.direcciontrabajo %}
          <div class="field">
            <span class="lab">Dirección de trabajo</span>
            <span class="val">{{ perfil.direcciontrabajo }}</span>
          </div>
          {% endif %}
        </section>

      </aside>

      <!-- ====== RIGHT (CONTENT) ====== -->
      <main class="main">

        {% if perfil.descripcionperfil %}
        <section class="sec">
          <h2 class="sec-title">Perfil</h2>
          <div class="summary">{{ perfil.descripcionperfil }}</div>
        </section>
        {% endif %}

        {% if experiencias and request.GET.exp != "off" %}
        <section class="sec">
          <h2 class="sec-title">Experiencia laboral</h2>
          {% for e in experiencias %}
          <div class="item">
            <div class="item-top">
              <div>
                <div class="item-title">{{ e.cargodesempenado }}</div>
                <div class="item-subtitle">{{ e.nombrempresa }}</div>
              </div>
              <div class="item-date">
                {{ e.fechainiciogestion|date:"M Y" }} —
                {% if e.fechafingestion %}{{ e.fechafingestion|date:"M Y" }}{% else %}Actual{% endif %}
              </div>
            </div>

            {% if e.descripcionfunciones %}
              <div class="item-body">{{ e.descripcionfunciones }}</div>
            {% endif %}
          </div>
          {% endfor %}
        </section>
        {% endif %}

        {% if cursos and request.GET.edu != "off" %}
        <section class="sec">
          <h2 class="sec-title">Formación</h2>
          {% for c in cursos %}
          <div class="item">
            <div class="item-top">
              <div>
                <div class="item-title">{{ c.nombrecurso }}</div>
                <div class="item-subtitle">{{ c.entidadpatrocinadora }}</div>
                <div style="margin-top:2mm">
                  {% if c.totalhoras %}<span class="chip">{{ c.totalhoras }} horas</span>{% endif %}
                </div>
              </div>
              <div class="item-date">
                {{ c.fechainicio|date:"Y" }}
              </div>
            </div>
          </div>
          {% endfor %}
        </section>
        {% endif %}

        {% if productos_academicos and request.GET.acad != "off" %}
        <section class="sec">
          <h2 class="sec-title">Productos académicos</h2>
          {% for p in productos_academicos %}
          <div class="item">
            <div class="item-top">
              <div>
                <div class="item-title">{{ p.nombrerecurso }}</div>
                <div class="item-subtitle">{{ p.clasificador }}</div>
              </div>
            </div>
            {% if p.descripcion %}
              <div class="item-body">{{ p.descripcion }}</div>
            {% endif %}
          </div>
          {% endfor %}
        </section>
        {% endif %}

        {% if productos_laborales and request.GET.lab != "off" %}
        <section class="sec">
          <h2 class="sec-title">Productos laborales</h2>
          {% for p in productos_laborales %}
          <div class="item">
            <div class="item-top">
              <div>
                <div class="item-title">{{ p.nombreproducto }}</div>
                {% if p.fechaproducto %}<div class="item-subtitle">{{ p.fechaproducto|date:"M Y" }}</div>{% endif %}
              </div>
              {% if p.fechaproducto %}
              <div class="item-date">{{ p.fechaproducto|date:"Y" }}</div>
              {% endif %}
            </div>
            {% if p.descripcion %}
              <div class="item-body">{{ p.descripcion }}</div>
            {% endif %}
          </div>
          {% endfor %}
        </section>
        {% endif %}

        {% if reconocimientos and request.GET.rec != "off" %}
        <section class="sec">
          <h2 class="sec-title">Logros</h2>
          {% for r in reconocimientos %}
          <div class="item">
            <div class="item-top">
              <div>
                <div class="item-title">{{ r.tiporeconocimiento }}</div>
                <div class="item-subtitle">{{ r.entidadpatrocinadora }}</div>
              </div>
              <div class="item-date">{{ r.fechareconocimiento|date:"Y" }}</div>
            </div>
            {% if r.descripcionreconocimiento %}
              <div class="item-body">{{ r.descripcionreconocimiento }}</div>
            {% endif %}
          </div>
          {% endfor %}
        </section>
        {% endif %}

      </main>
    </div>
  </div>
</body>
</html>
